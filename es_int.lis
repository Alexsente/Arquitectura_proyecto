00000000                                     1  * Inicializa el SP y el PC
00000000                                     2          ORG     $0
00000000  00008000                           3          DC.L    $8000           *Pila
00000004  00002524                           4          DC.L    INICIO          *PC
00000400                                     5          ORG     $400
00000400                                     6  
00000400                                     7  	*Buffers
00000400                                     8  BUS_RBA:DS.B 2001
00000BD1                                     9  BUS_RBB:DS.B 2001
000013A2                                    10  BUS_TBA:DS.B 2001
00001B73                                    11  BUS_TBB:DS.B 2001
00002344                                    12  
00002344                                    13  	*Punteros
00002344                                    14  RBA_IN_PUNT: DS.B 4
00002348                                    15  RBA_FIN_PUNT:DS.B 4
0000234C                                    16  RBA_EXT_PUNT:DS.B 4
00002350                                    17  RBA_INT_PUNT:DS.B 4
00002354                                    18  RBB_IN_PUNT: DS.B 4
00002358                                    19  RBB_FIN_PUNT:DS.B 4
0000235C                                    20  RBB_EXT_PUNT:DS.B 4
00002360                                    21  RBB_INT_PUNT:DS.B 4
00002364                                    22  TBA_IN_PUNT: DS.B 4
00002368                                    23  TBA_FIN_PUNT:DS.B 4
0000236C                                    24  TBA_EXT_PUNT:DS.B 4
00002370                                    25  TBA_INT_PUNT:DS.B 4
00002374                                    26  TBB_IN_PUNT: DS.B 4
00002378                                    27  TBB_FIN_PUNT:DS.B 4
0000237C                                    28  TBB_EXT_PUNT:DS.B 4
00002380                                    29  TBB_INT_PUNT:DS.B 4
00002384                                    30  
00002384                                    31  
00002384                                    32  
00002384                                    33  * Definicion de equivalencias
00002384                                    34  
00002384  =00EFFC01                         35  MR1A    EQU     $effc01       * de modo A (escritura)
00002384  =00EFFC01                         36  MR2A    EQU     $effc01       * de modo A (2 escritura)
00002384  =00EFFC03                         37  SRA     EQU     $effc03       * de estado A (lectura)
00002384  =00EFFC03                         38  CSRA    EQU     $effc03       * de seleccion de reloj A (escritura)
00002384  =00EFFC05                         39  CRA     EQU     $effc05       * de control A (escritura)
00002384  =00EFFC07                         40  TBA     EQU     $effc07       * buffer transmision A (escritura)
00002384  =00EFFC07                         41  RBA     EQU     $effc07       * buffer recepcion A  (lectura)
00002384  =00EFFC17                         42  TBB     EQU     $effc17       * buffer trasmisión B
00002384  =00EFFC17                         43  RBB     EQU     $effc17       * buffer recepción B
00002384  =00EFFC09                         44  ACR     EQU     $effc09       * de control auxiliar
00002384  =00EFFC0B                         45  IMR     EQU     $effc0B       * de mascara de interrupcion A (escritura)
00002384  =00EFFC0B                         46  ISR     EQU     $effc0B       * de estado de interrupcion A (lectura)
00002384                                    47  
00002384                                    48  *INIT
00002384                                    49  INIT:
00002384  21FC 00000400 2344                50  	MOVE.L #BUS_RBA,RBA_IN_PUNT
0000238C  21FC 00000400 234C                51  	MOVE.L #BUS_RBA,RBA_EXT_PUNT
00002394  21FC 00000400 2350                52  	MOVE.L #BUS_RBA,RBA_INT_PUNT
0000239C  21FC 00000400 2348                53  	MOVE.L #BUS_RBA,RBA_FIN_PUNT
000023A4  06B8 00002000 2348                54  	ADD.L  #$2000,RBA_FIN_PUNT
000023AC  21FC 00000BD1 2354                55  	MOVE.L #BUS_RBB,RBB_IN_PUNT
000023B4  21FC 00000BD1 235C                56  	MOVE.L #BUS_RBB,RBB_EXT_PUNT
000023BC  21FC 00000BD1 2360                57  	MOVE.L #BUS_RBB,RBB_INT_PUNT
000023C4  21FC 00000BD1 2358                58  	MOVE.L #BUS_RBB,RBB_FIN_PUNT
000023CC  06B8 00002000 2358                59  	ADD.L  #$2000,RBB_FIN_PUNT
000023D4  21FC 000013A2 2364                60  	MOVE.L #BUS_TBA,TBA_IN_PUNT
000023DC  21FC 000013A2 236C                61  	MOVE.L #BUS_TBA,TBA_EXT_PUNT
000023E4  21FC 000013A2 2370                62  	MOVE.L #BUS_TBA,TBA_INT_PUNT
000023EC  21FC 000013A2 2368                63  	MOVE.L #BUS_TBA,TBA_FIN_PUNT
000023F4  06B8 00002000 2368                64  	ADD.L  #$2000,TBA_FIN_PUNT
000023FC  21FC 00001B73 2374                65  	MOVE.L #BUS_TBB,TBB_IN_PUNT
00002404  21FC 00001B73 237C                66  	MOVE.L #BUS_TBB,TBB_EXT_PUNT
0000240C  21FC 00001B73 2380                67  	MOVE.L #BUS_TBB,TBB_INT_PUNT
00002414  21FC 00001B73 2378                68  	MOVE.L #BUS_TBB,TBB_FIN_PUNT
0000241C  06B8 00002000 2378                69  	ADD.L  #$2000,TBB_FIN_PUNT
00002424  4E75                              70  	RTS
00002426                                    71  
00002426                                    72  *********************LEECAR**********************
00002426                                    73  
00002426                                    74  LEECAR:
00002426                                    75  
00002426  0800 0000                         76    BTST    #0,D0
0000242A  6700 0042                         77    BEQ LINEA_A
0000242E                                    78  
0000242E                                    79  LINEA_B:
0000242E                                    80  
0000242E  0800 0001                         81    BTST #1,D0
00002432  6700 001E                         82    BEQ REC_B
00002436                                    83  TRANS_B:
00002436                                    84  
00002436                                    85  
00002436  2678 237C                         86    MOVE.L TBB_EXT_PUNT,A3
0000243A  2878 2380                         87    MOVE.L TBB_INT_PUNT,A4
0000243E  B8CB                              88    CMP  A3,A4
00002440  2A78 237C                         89    MOVE.L  TBB_EXT_PUNT,A5
00002444  6700 0064                         90    BEQ  VACIO
00002448  201D                              91    MOVE.L  (A5)+,D0
0000244A  21CD 237C                         92    MOVE.L  A5,TBB_EXT_PUNT
0000244E  6000 005C                         93    BRA FIN_LEECAR
00002452                                    94  REC_B:
00002452                                    95  
00002452  2678 235C                         96    MOVE.L RBB_EXT_PUNT,A3
00002456  2878 2360                         97    MOVE.L RBB_INT_PUNT,A4
0000245A  B8CB                              98    CMP  A3,A4
0000245C  6700 004C                         99    BEQ VACIO
00002460  2A78 235C                        100    MOVE.L  RBB_EXT_PUNT,A5
00002464  201D                             101    MOVE.L  (A5)+,D0
00002466  21CD 235C                        102    MOVE.L A5,RBB_EXT_PUNT
0000246A  6000 0040                        103    BRA FIN_LEECAR
0000246E                                   104  
0000246E                                   105  LINEA_A:
0000246E                                   106  
0000246E  0800 0001                        107    BTST   #1,D0
00002472  6700 001E                        108          BEQ REC_A
00002476                                   109  TRANS_A:
00002476                                   110  
00002476  2678 236C                        111    MOVE.L TBA_EXT_PUNT,A3
0000247A  2878 2370                        112    MOVE.L TBA_INT_PUNT,A4
0000247E  B8CB                             113    CMP  A3,A4
00002480  6700 0028                        114    BEQ VACIO
00002484  2A78 236C                        115    MOVE.L  TBA_EXT_PUNT,A5
00002488  201D                             116    MOVE.L  (A5)+,D0
0000248A  21CD 236C                        117    MOVE.L  A5,TBA_EXT_PUNT
0000248E  6000 001C                        118    BRA FIN_LEECAR
00002492                                   119  
00002492                                   120  REC_A:
00002492                                   121  
00002492  2678 234C                        122    MOVE.L RBA_EXT_PUNT,A3
00002496  2878 2350                        123    MOVE.L RBA_INT_PUNT,A4
0000249A  B8CB                             124    CMP A3,A4
0000249C  6700 000C                        125    BEQ VACIO
000024A0  2A78 234C                        126    MOVE.L RBA_EXT_PUNT,A5
000024A4  101D                             127    MOVE.B (A5)+,D0
000024A6  21CD 234C                        128    MOVE.L A5,RBA_EXT_PUNT
000024AA                                   129  
000024AA                                   130    VACIO:
000024AA  7001                             131    MOVE.L #1,D0
000024AC  4E75                             132    FIN_LEECAR:     RTS
000024AE                                   133  
000024AE                                   134  ********************ESCCAR********************
000024AE                                   135  ESCCAR:
000024AE                                   136  
000024AE  0800 0000                        137  	BTST 	#0,D0
000024B2  6700 0034                        138  	BEQ ELINEA_A
000024B6                                   139  
000024B6                                   140  ELINEA_B:
000024B6                                   141  
000024B6  0800 0001                        142    BTST #1,D0
000024BA  6700 0016                        143  	BEQ EREC_B
000024BE                                   144  
000024BE                                   145  ETRANS_B:
000024BE  7000                             146    MOVE.L #0,D0
000024C0  2878 2368                        147    MOVE.L  TBA_FIN_PUNT,A4     **Guarda en el registro A4 el puntero de fin de buffer
000024C4  2A78 2380                        148    MOVE.L	TBB_INT_PUNT,A5           *Guarda en el registro A5 el puntero de introduccion de dato
000024C8  BACC                             149    CMP A4,A5
000024CA  67DE                             150    BEQ VACIO
000024CC  2AC1                             151  	MOVE.L  D1,(A5)+           *Push del registro D1 en el buffer
000024CE  21CD 2374                        152    MOVE.L  A5,TBB_IN_PUNT            *Guarda la nueva direcion del puntero
000024D2                                   153  
000024D2                                   154  EREC_B:
000024D2  7000                             155    MOVE.L #0,D0
000024D4  2878 2358                        156    MOVE.L  RBB_FIN_PUNT,A4     **Guarda en el registro A4 el puntero de fin de buffer
000024D8  2A78 2360                        157    MOVE.L 	RBB_INT_PUNT,A5            *Guarda en el registro A5 el puntero de introduccion de dato
000024DC  BACC                             158    CMP A4,A5
000024DE  67CA                             159    BEQ VACIO
000024E0  2AC1                             160  	MOVE.L  D1,(A5)+           *Push del registro D1 en el buffer
000024E2  21CD 2354                        161  	MOVE.L  A5,RBB_IN_PUNT           *Guarda la nueva direcion del puntero
000024E6  4E75                             162    RTS
000024E8                                   163  
000024E8                                   164  ELINEA_A:
000024E8                                   165  
000024E8  0800 0001                        166    BTST   #1,D0
000024EC  6700 0018                        167  	BEQ EREC_A
000024F0                                   168  
000024F0                                   169    ETRANS_A:
000024F0  7000                             170    MOVE.L #0,D0
000024F2  2878 2368                        171    MOVE.L  TBA_FIN_PUNT,A4     *Guarda en el registro A4 el puntero de fin de buffer
000024F6  2A78 2370                        172    MOVE.L	TBA_INT_PUNT,A5           *Guarda en el registro A5 el puntero de introduccion de dato
000024FA  BACC                             173    CMP A4,A5
000024FC  67AC                             174    BEQ VACIO
000024FE  2AC1                             175  	MOVE.L  D1,(A5)+           *Push del registro D1 en el buffer
00002500  21CD 2364                        176  	MOVE.L  A5,TBA_IN_PUNT           *Guarda la nueva direcion del puntero
00002504  4E75                             177    RTS
00002506                                   178  
00002506                                   179    EREC_A:
00002506  7000                             180    MOVE.L #0,D0
00002508  2878 2348                        181    MOVE.L  RBA_FIN_PUNT,A4      *Guarda en el registro A4 el puntero de fin de buffer
0000250C  2A78 2350                        182    MOVE.L 	RBA_INT_PUNT,A5      *Guarda en el registro A5 el puntero de introduccion de dato
00002510  BACC                             183    CMP A4,A5
00002512  6796                             184    BEQ VACIO
00002514  2AC1                             185  	MOVE.L  D1,(A5)+           *Push del registro D1 en el buffer
00002516  21CD 2344                        186  	MOVE.L  A5,RBA_IN_PUNT           *Guarda la nueva direcion del puntero
0000251A  4E75                             187  	RTS
0000251C                                   188  
0000251C                                   189  *PRINT
0000251C  4E75                             190  PRINT:RTS
0000251E                                   191  *LINEA
0000251E  4E75                             192  LINEA:RTS
00002520                                   193  *SCAN
00002520  4E75                             194  SCAN:RTS
00002522                                   195  *RTI
00002522  4E75                             196  RTI:RTS
00002524                                   197  *Programa Principal
00002524  6100 FE5E                        198  INICIO: BSR INIT
00002528  7012                             199  	MOVE.L #$12,D0
0000252A  7237                             200    MOVE.L #$37,D1
0000252C  6180                             201    BSR ESCCAR
0000252E  6100 FEF6                        202  	BSR LEECAR
00002532                                   203  
00002532  4848                             204  	BREAK

No errors detected
No warnings generated
